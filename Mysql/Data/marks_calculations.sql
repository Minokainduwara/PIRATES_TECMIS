---------------------------------------------
1. Calculate Continuous Assessment (CA) Marks
---------------------------------------------



/////////////////////
Code 
////////////////////

CREATE VIEW ContinuousAssessment AS
SELECT 
    StudentID,
    Sub_ID,
    SUM(MarksObtained) AS Total_Marks,
    COUNT(AssessmentType) AS CA_Count,
    (SUM(MarksObtained) / (COUNT(AssessmentType) * 100)) * 100 AS CA_Percentage
FROM 
    Marks
WHERE 
    AssessmentType IN ('Quiz', 'Assessment', 'Midterm_Theory', 'Final_Theory')
GROUP BY 
    StudentID, Sub_ID;








CREATE VIEW CA_40_Percentage AS
SELECT 
    StudentID,
    Sub_ID,
    (CA_Percentage * 0.4) AS CA_40
FROM 
    ContinuousAssessment;



----------------------------------------------------------------------------
SELECT * FROM ContinuousAssessment;

SELECT StudentID, Sub_ID, CA_40_Percentage FROM CA_40_Percentage;

----------------------------------------------------------------------------



//////////////
Output
/////////////


mysql> CREATE VIEW ContinuousAssessment AS
    -> SELECT
    ->     StudentID,
    ->     Sub_ID,
    ->     SUM(MarksObtained) AS Total_Marks,
    ->     COUNT(AssessmentType) AS CA_Count,
    ->     (SUM(MarksObtained) / (COUNT(AssessmentType) * 100)) * 100 AS CA_Percentage
    -> FROM
    ->     Marks
    -> WHERE
    ->     AssessmentType IN ('Quiz', 'Assessment', 'Midterm_Theory', 'Final_Theory')
    -> GROUP BY
    ->     StudentID, Sub_ID;
Query OK, 0 rows affected (0.02 sec)







mysql> CREATE VIEW CA_40_Percentage AS
    -> SELECT
    ->     StudentID,
    ->     Sub_ID,
    ->     Total_Marks,
    ->     CA_Count,
    ->     CA_Percentage,
    ->     (CA_Percentage * 0.4) AS CA_40_Percentage
    -> FROM
    ->     ContinuousAssessment;
Query OK, 0 rows affected (0.01 sec)






mysql> SELECT * FROM ContinuousAssessment;
+-----------+---------+-------------+----------+---------------+
| StudentID | Sub_ID  | Total_Marks | CA_Count | CA_Percentage |
+-----------+---------+-------------+----------+---------------+
| TG1350    | ICT1112 |      357.00 |        4 |     89.250000 |
| TG1351    | ICT1112 |      319.00 |        4 |     79.750000 |
| TG1352    | ICT1112 |      354.00 |        4 |     88.500000 |
| TG1353    | ICT1112 |      332.00 |        4 |     83.000000 |
| TG1354    | ICT1112 |      367.00 |        4 |     91.750000 |
| TG1355    | ICT1112 |      298.00 |        4 |     74.500000 |
| TG1356    | ICT1112 |      326.00 |        4 |     81.500000 |
| TG1357    | ICT1112 |      283.00 |        4 |     70.750000 |
| TG1358    | ICT1112 |      284.00 |        4 |     71.000000 |
| TG1359    | ICT1112 |      371.00 |        4 |     92.750000 |
| TG1100    | ICT1112 |      210.00 |        4 |     52.500000 |
| TG1101    | ICT1112 |      236.00 |        4 |     59.000000 |
| TG1102    | ICT1112 |      193.00 |        4 |     48.250000 |
| TG1103    | ICT1112 |      153.00 |        4 |     38.250000 |
| TG1104    | ICT1112 |      123.00 |        4 |     30.750000 |
| TG1350    | TMS1113 |      269.00 |        3 |     89.666667 |
| TG1351    | TMS1113 |      213.00 |        3 |     71.000000 |
| TG1352    | TMS1113 |      250.00 |        3 |     83.333333 |
| TG1353    | TMS1113 |      229.00 |        3 |     76.333333 |
| TG1354    | TMS1113 |      272.00 |        3 |     90.666667 |
| TG1355    | TMS1113 |      174.00 |        3 |     58.000000 |
| TG1356    | TMS1113 |      198.00 |        3 |     66.000000 |
| TG1357    | TMS1113 |      161.00 |        3 |     53.666667 |
| TG1358    | TMS1113 |      209.00 |        3 |     69.666667 |
| TG1359    | TMS1113 |      243.00 |        3 |     81.000000 |
| TG1100    | TMS1113 |      125.00 |        3 |     41.666667 |
| TG1101    | TMS1113 |      156.00 |        3 |     52.000000 |
| TG1102    | TMS1113 |      113.00 |        3 |     37.666667 |
| TG1103    | TMS1113 |       85.00 |        3 |     28.333333 |
| TG1104    | TMS1113 |       61.00 |        3 |     20.333333 |
| TG1350    | ENG1114 |      355.00 |        4 |     88.750000 |
| TG1351    | ENG1114 |      309.00 |        4 |     77.250000 |
| TG1352    | ENG1114 |      350.00 |        4 |     87.500000 |
| TG1353    | ENG1114 |      251.00 |        4 |     62.750000 |
| TG1354    | ENG1114 |      330.00 |        4 |     82.500000 |
| TG1355    | ENG1114 |      168.00 |        4 |     42.000000 |
| TG1356    | ENG1114 |      210.00 |        4 |     52.500000 |
| TG1357    | ENG1114 |      189.00 |        4 |     47.250000 |
| TG1358    | ENG1114 |      281.00 |        4 |     70.250000 |
| TG1359    | ENG1114 |      327.00 |        4 |     81.750000 |
| TG1100    | ENG1114 |      112.00 |        4 |     28.000000 |
| TG1101    | ENG1114 |      211.00 |        4 |     52.750000 |
| TG1102    | ENG1114 |      153.00 |        4 |     38.250000 |
| TG1103    | ENG1114 |      110.00 |        4 |     27.500000 |
| TG1104    | ENG1114 |       79.00 |        4 |     19.750000 |
| TG1350    | ICT1122 |      359.00 |        4 |     89.750000 |
| TG1351    | ICT1122 |      313.00 |        4 |     78.250000 |
| TG1352    | ICT1122 |      349.00 |        4 |     87.250000 |
| TG1353    | ICT1122 |      252.00 |        4 |     63.000000 |
| TG1354    | ICT1122 |      316.00 |        4 |     79.000000 |
| TG1355    | ICT1122 |      164.00 |        4 |     41.000000 |
| TG1356    | ICT1122 |      217.00 |        4 |     54.250000 |
| TG1357    | ICT1122 |      166.00 |        4 |     41.500000 |
| TG1358    | ICT1122 |      288.00 |        4 |     72.000000 |
| TG1359    | ICT1122 |      326.00 |        4 |     81.500000 |
| TG1100    | ICT1122 |      101.00 |        4 |     25.250000 |
| TG1101    | ICT1122 |      188.00 |        4 |     47.000000 |
| TG1102    | ICT1122 |      137.00 |        4 |     34.250000 |
| TG1103    | ICT1122 |      116.00 |        4 |     29.000000 |
| TG1104    | ICT1122 |       90.00 |        4 |     22.500000 |
| TG1350    | ICT1132 |      361.00 |        4 |     90.250000 |
| TG1351    | ICT1132 |      304.00 |        4 |     76.000000 |
| TG1352    | ICT1132 |      344.00 |        4 |     86.000000 |
| TG1353    | ICT1132 |      251.00 |        4 |     62.750000 |
| TG1354    | ICT1132 |      324.00 |        4 |     81.000000 |
| TG1355    | ICT1132 |      170.00 |        4 |     42.500000 |
| TG1356    | ICT1132 |      212.00 |        4 |     53.000000 |
| TG1357    | ICT1132 |      164.00 |        4 |     41.000000 |
| TG1358    | ICT1132 |      300.00 |        4 |     75.000000 |
| TG1359    | ICT1132 |      330.00 |        4 |     82.500000 |
| TG1100    | ICT1132 |      110.00 |        4 |     27.500000 |
| TG1101    | ICT1132 |      182.00 |        4 |     45.500000 |
| TG1102    | ICT1132 |      138.00 |        4 |     34.500000 |
| TG1103    | ICT1132 |      115.00 |        4 |     28.750000 |
| TG1104    | ICT1132 |       85.00 |        4 |     21.250000 |
| TG1350    | ICT1153 |      344.00 |        4 |     86.000000 |
| TG1351    | ICT1153 |      310.00 |        4 |     77.500000 |
| TG1352    | ICT1153 |      270.00 |        4 |     67.500000 |
| TG1353    | ICT1153 |      316.00 |        4 |     79.000000 |
| TG1354    | ICT1153 |      344.00 |        4 |     86.000000 |
| TG1355    | ICT1153 |      324.00 |        4 |     81.000000 |
| TG1356    | ICT1153 |      290.00 |        4 |     72.500000 |
| TG1357    | ICT1153 |      344.00 |        4 |     86.000000 |
| TG1358    | ICT1153 |      310.00 |        4 |     77.500000 |
| TG1359    | ICT1153 |      304.00 |        4 |     76.000000 |
| TG1100    | ICT1153 |      130.00 |        4 |     32.500000 |
| TG1101    | ICT1153 |      110.00 |        4 |     27.500000 |
| TG1102    | ICT1153 |       90.00 |        4 |     22.500000 |
| TG1103    | ICT1153 |       66.00 |        4 |     16.500000 |
| TG1104    | ICT1153 |       44.00 |        4 |     11.000000 |
| TG1350    | ICT1161 |      692.00 |        8 |     86.500000 |
| TG1351    | ICT1161 |      652.00 |        8 |     81.500000 |
| TG1352    | ICT1161 |      630.00 |        8 |     78.750000 |
| TG1353    | ICT1161 |      678.00 |        8 |     84.750000 |
| TG1354    | ICT1161 |      664.00 |        8 |     83.000000 |
| TG1355    | ICT1161 |      652.00 |        8 |     81.500000 |
| TG1356    | ICT1161 |      604.00 |        8 |     75.500000 |
| TG1357    | ICT1161 |      690.00 |        8 |     86.250000 |
| TG1358    | ICT1161 |      652.00 |        8 |     81.500000 |
| TG1359    | ICT1161 |      620.00 |        8 |     77.500000 |
| TG1100    | ICT1161 |      324.00 |        8 |     40.500000 |
| TG1101    | ICT1161 |      270.00 |        8 |     33.750000 |
| TG1102    | ICT1161 |      220.00 |        8 |     27.500000 |
| TG1103    | ICT1161 |      190.00 |        8 |     23.750000 |
| TG1104    | ICT1161 |      170.00 |        8 |     21.250000 |
| TG1350    | ICT1142 |      179.00 |        2 |     89.500000 |
| TG1351    | ICT1142 |      155.00 |        2 |     77.500000 |
| TG1352    | ICT1142 |      135.00 |        2 |     67.500000 |
| TG1353    | ICT1142 |      158.00 |        2 |     79.000000 |
| TG1354    | ICT1142 |      172.00 |        2 |     86.000000 |
| TG1355    | ICT1142 |      162.00 |        2 |     81.000000 |
| TG1356    | ICT1142 |      145.00 |        2 |     72.500000 |
| TG1357    | ICT1142 |      172.00 |        2 |     86.000000 |
| TG1358    | ICT1142 |      155.00 |        2 |     77.500000 |
| TG1359    | ICT1142 |      152.00 |        2 |     76.000000 |
| TG1100    | ICT1142 |       65.00 |        2 |     32.500000 |
| TG1101    | ICT1142 |       55.00 |        2 |     27.500000 |
| TG1102    | ICT1142 |       45.00 |        2 |     22.500000 |
| TG1103    | ICT1142 |       33.00 |        2 |     16.500000 |
| TG1104    | ICT1142 |       22.00 |        2 |     11.000000 |
| TG1350    | ICT1212 |      361.00 |        4 |     90.250000 |
| TG1351    | ICT1212 |      349.00 |        4 |     87.250000 |
| TG1352    | ICT1212 |      333.00 |        4 |     83.250000 |
| TG1353    | ICT1212 |      339.00 |        4 |     84.750000 |
| TG1354    | ICT1212 |      350.00 |        4 |     87.500000 |
| TG1355    | ICT1212 |      341.00 |        4 |     85.250000 |
| TG1356    | ICT1212 |      333.00 |        4 |     83.250000 |
| TG1357    | ICT1212 |      353.00 |        4 |     88.250000 |
| TG1358    | ICT1212 |      324.00 |        4 |     81.000000 |
| TG1359    | ICT1212 |      317.00 |        4 |     79.250000 |
| TG1100    | ICT1212 |      155.00 |        4 |     38.750000 |
| TG1101    | ICT1212 |      142.00 |        4 |     35.500000 |
| TG1102    | ICT1212 |      124.00 |        4 |     31.000000 |
| TG1103    | ICT1212 |      109.00 |        4 |     27.250000 |
| TG1104    | ICT1212 |       92.00 |        4 |     23.000000 |
| TG1350    | TMS1233 |      338.00 |        4 |     84.500000 |
| TG1351    | TMS1233 |      344.00 |        4 |     86.000000 |
| TG1352    | TMS1233 |      343.00 |        4 |     85.750000 |
| TG1353    | TMS1233 |      337.00 |        4 |     84.250000 |
| TG1354    | TMS1233 |      349.00 |        4 |     87.250000 |
| TG1355    | TMS1233 |      322.00 |        4 |     80.500000 |
| TG1356    | TMS1233 |      344.00 |        4 |     86.000000 |
| TG1357    | TMS1233 |      331.00 |        4 |     82.750000 |
| TG1358    | TMS1233 |      350.00 |        4 |     87.500000 |
| TG1359    | TMS1233 |      337.00 |        4 |     84.250000 |
| TG1100    | TMS1233 |      131.00 |        4 |     32.750000 |
| TG1101    | TMS1233 |      118.00 |        4 |     29.500000 |
| TG1102    | TMS1233 |      107.00 |        4 |     26.750000 |
| TG1103    | TMS1233 |       86.00 |        4 |     21.500000 |
| TG1104    | TMS1233 |       79.00 |        4 |     19.750000 |
| TG1350    | ENG1222 |      361.00 |        4 |     90.250000 |
| TG1351    | ENG1222 |      354.00 |        4 |     88.500000 |
| TG1352    | ENG1222 |      345.00 |        4 |     86.250000 |
| TG1353    | ENG1222 |      339.00 |        4 |     84.750000 |
| TG1354    | ENG1222 |      357.00 |        4 |     89.250000 |
| TG1355    | ENG1222 |      343.00 |        4 |     85.750000 |
| TG1356    | ENG1222 |      351.00 |        4 |     87.750000 |
| TG1357    | ENG1222 |      338.00 |        4 |     84.500000 |
| TG1358    | ENG1222 |      351.00 |        4 |     87.750000 |
| TG1359    | ENG1222 |      343.00 |        4 |     85.750000 |
| TG1100    | ENG1222 |      110.00 |        4 |     27.500000 |
| TG1101    | ENG1222 |      115.00 |        4 |     28.750000 |
| TG1102    | ENG1222 |      130.00 |        4 |     32.500000 |
| TG1103    | ENG1222 |      113.00 |        4 |     28.250000 |
| TG1104    | ENG1222 |      106.00 |        4 |     26.500000 |
| TG1350    | TCS1212 |      361.00 |        4 |     90.250000 |
| TG1351    | TCS1212 |      349.00 |        4 |     87.250000 |
| TG1352    | TCS1212 |      347.00 |        4 |     86.750000 |
| TG1353    | TCS1212 |      337.00 |        4 |     84.250000 |
| TG1354    | TCS1212 |      357.00 |        4 |     89.250000 |
| TG1355    | TCS1212 |      346.00 |        4 |     86.500000 |
| TG1356    | TCS1212 |      348.00 |        4 |     87.000000 |
| TG1357    | TCS1212 |      337.00 |        4 |     84.250000 |
| TG1358    | TCS1212 |      352.00 |        4 |     88.000000 |
| TG1359    | TCS1212 |      334.00 |        4 |     83.500000 |
| TG1100    | TCS1212 |      114.00 |        4 |     28.500000 |
| TG1101    | TCS1212 |      114.00 |        4 |     28.500000 |
| TG1102    | TCS1212 |      112.00 |        4 |     28.000000 |
| TG1103    | TCS1212 |      105.00 |        4 |     26.250000 |
| TG1104    | TCS1212 |      108.00 |        4 |     27.000000 |
| TG1350    | ICT1233 |      271.00 |        3 |     90.333333 |
| TG1351    | ICT1233 |      266.00 |        3 |     88.666667 |
| TG1352    | ICT1233 |      262.00 |        3 |     87.333333 |
| TG1353    | ICT1233 |      260.00 |        3 |     86.666667 |
| TG1354    | ICT1233 |      270.00 |        3 |     90.000000 |
| TG1355    | ICT1233 |      262.00 |        3 |     87.333333 |
| TG1356    | ICT1233 |      261.00 |        3 |     87.000000 |
| TG1357    | ICT1233 |      259.00 |        3 |     86.333333 |
| TG1358    | ICT1233 |      269.00 |        3 |     89.666667 |
| TG1359    | ICT1233 |      259.00 |        3 |     86.333333 |
| TG1100    | ICT1233 |       83.00 |        3 |     27.666667 |
| TG1101    | ICT1233 |       90.00 |        3 |     30.000000 |
| TG1102    | ICT1233 |       83.00 |        3 |     27.666667 |
| TG1103    | ICT1233 |       80.00 |        3 |     26.666667 |
| TG1104    | ICT1233 |       81.00 |        3 |     27.000000 |
| TG1350    | ICT1242 |      361.00 |        4 |     90.250000 |
| TG1351    | ICT1242 |      350.00 |        4 |     87.500000 |
| TG1352    | ICT1242 |      345.00 |        4 |     86.250000 |
| TG1353    | ICT1242 |      366.00 |        4 |     91.500000 |
| TG1354    | ICT1242 |      343.00 |        4 |     85.750000 |
| TG1355    | ICT1242 |      326.00 |        4 |     81.500000 |
| TG1356    | ICT1242 |      309.00 |        4 |     77.250000 |
| TG1357    | ICT1242 |      296.00 |        4 |     74.000000 |
| TG1358    | ICT1242 |      298.00 |        4 |     74.500000 |
| TG1359    | ICT1242 |      288.00 |        4 |     72.000000 |
| TG1100    | ICT1242 |      112.00 |        4 |     28.000000 |
| TG1101    | ICT1242 |      115.00 |        4 |     28.750000 |
| TG1102    | ICT1242 |      112.00 |        4 |     28.000000 |
| TG1103    | ICT1242 |      105.00 |        4 |     26.250000 |
| TG1104    | ICT1242 |      106.00 |        4 |     26.500000 |
| TG1350    | ICT1253 |      271.00 |        3 |     90.333333 |
| TG1351    | ICT1253 |      269.00 |        3 |     89.666667 |
| TG1352    | ICT1253 |      254.00 |        3 |     84.666667 |
| TG1353    | ICT1253 |      270.00 |        3 |     90.000000 |
| TG1354    | ICT1253 |      258.00 |        3 |     86.000000 |
| TG1355    | ICT1253 |      258.00 |        3 |     86.000000 |
| TG1356    | ICT1253 |      273.00 |        3 |     91.000000 |
| TG1357    | ICT1253 |      262.00 |        3 |     87.333333 |
| TG1358    | ICT1253 |      272.00 |        3 |     90.666667 |
| TG1359    | ICT1253 |      276.00 |        3 |     92.000000 |
| TG1100    | ICT1253 |       87.00 |        3 |     29.000000 |
| TG1101    | ICT1253 |       87.00 |        3 |     29.000000 |
| TG1102    | ICT1253 |       95.00 |        3 |     31.666667 |
| TG1103    | ICT1253 |       82.00 |        3 |     27.333333 |
| TG1104    | ICT1253 |       66.00 |        3 |     22.000000 |
+-----------+---------+-------------+----------+---------------+
225 rows in set (0.02 sec)


mysql> SELECT StudentID, Sub_ID, CA_40_Percentage FROM CA_40_Percentage;
+-----------+---------+------------------+
| StudentID | Sub_ID  | CA_40_Percentage |
+-----------+---------+------------------+
| TG1350    | ICT1112 |       35.7000000 |
| TG1351    | ICT1112 |       31.9000000 |
| TG1352    | ICT1112 |       35.4000000 |
| TG1353    | ICT1112 |       33.2000000 |
| TG1354    | ICT1112 |       36.7000000 |
| TG1355    | ICT1112 |       29.8000000 |
| TG1356    | ICT1112 |       32.6000000 |
| TG1357    | ICT1112 |       28.3000000 |
| TG1358    | ICT1112 |       28.4000000 |
| TG1359    | ICT1112 |       37.1000000 |
| TG1100    | ICT1112 |       21.0000000 |
| TG1101    | ICT1112 |       23.6000000 |
| TG1102    | ICT1112 |       19.3000000 |
| TG1103    | ICT1112 |       15.3000000 |
| TG1104    | ICT1112 |       12.3000000 |
| TG1350    | TMS1113 |       35.8666668 |
| TG1351    | TMS1113 |       28.4000000 |
| TG1352    | TMS1113 |       33.3333332 |
| TG1353    | TMS1113 |       30.5333332 |
| TG1354    | TMS1113 |       36.2666668 |
| TG1355    | TMS1113 |       23.2000000 |
| TG1356    | TMS1113 |       26.4000000 |
| TG1357    | TMS1113 |       21.4666668 |
| TG1358    | TMS1113 |       27.8666668 |
| TG1359    | TMS1113 |       32.4000000 |
| TG1100    | TMS1113 |       16.6666668 |
| TG1101    | TMS1113 |       20.8000000 |
| TG1102    | TMS1113 |       15.0666668 |
| TG1103    | TMS1113 |       11.3333332 |
| TG1104    | TMS1113 |        8.1333332 |
| TG1350    | ENG1114 |       35.5000000 |
| TG1351    | ENG1114 |       30.9000000 |
| TG1352    | ENG1114 |       35.0000000 |
| TG1353    | ENG1114 |       25.1000000 |
| TG1354    | ENG1114 |       33.0000000 |
| TG1355    | ENG1114 |       16.8000000 |
| TG1356    | ENG1114 |       21.0000000 |
| TG1357    | ENG1114 |       18.9000000 |
| TG1358    | ENG1114 |       28.1000000 |
| TG1359    | ENG1114 |       32.7000000 |
| TG1100    | ENG1114 |       11.2000000 |
| TG1101    | ENG1114 |       21.1000000 |
| TG1102    | ENG1114 |       15.3000000 |
| TG1103    | ENG1114 |       11.0000000 |
| TG1104    | ENG1114 |        7.9000000 |
| TG1350    | ICT1122 |       35.9000000 |
| TG1351    | ICT1122 |       31.3000000 |
| TG1352    | ICT1122 |       34.9000000 |
| TG1353    | ICT1122 |       25.2000000 |
| TG1354    | ICT1122 |       31.6000000 |
| TG1355    | ICT1122 |       16.4000000 |
| TG1356    | ICT1122 |       21.7000000 |
| TG1357    | ICT1122 |       16.6000000 |
| TG1358    | ICT1122 |       28.8000000 |
| TG1359    | ICT1122 |       32.6000000 |
| TG1100    | ICT1122 |       10.1000000 |
| TG1101    | ICT1122 |       18.8000000 |
| TG1102    | ICT1122 |       13.7000000 |
| TG1103    | ICT1122 |       11.6000000 |
| TG1104    | ICT1122 |        9.0000000 |
| TG1350    | ICT1132 |       36.1000000 |
| TG1351    | ICT1132 |       30.4000000 |
| TG1352    | ICT1132 |       34.4000000 |
| TG1353    | ICT1132 |       25.1000000 |
| TG1354    | ICT1132 |       32.4000000 |
| TG1355    | ICT1132 |       17.0000000 |
| TG1356    | ICT1132 |       21.2000000 |
| TG1357    | ICT1132 |       16.4000000 |
| TG1358    | ICT1132 |       30.0000000 |
| TG1359    | ICT1132 |       33.0000000 |
| TG1100    | ICT1132 |       11.0000000 |
| TG1101    | ICT1132 |       18.2000000 |
| TG1102    | ICT1132 |       13.8000000 |
| TG1103    | ICT1132 |       11.5000000 |
| TG1104    | ICT1132 |        8.5000000 |
| TG1350    | ICT1153 |       34.4000000 |
| TG1351    | ICT1153 |       31.0000000 |
| TG1352    | ICT1153 |       27.0000000 |
| TG1353    | ICT1153 |       31.6000000 |
| TG1354    | ICT1153 |       34.4000000 |
| TG1355    | ICT1153 |       32.4000000 |
| TG1356    | ICT1153 |       29.0000000 |
| TG1357    | ICT1153 |       34.4000000 |
| TG1358    | ICT1153 |       31.0000000 |
| TG1359    | ICT1153 |       30.4000000 |
| TG1100    | ICT1153 |       13.0000000 |
| TG1101    | ICT1153 |       11.0000000 |
| TG1102    | ICT1153 |        9.0000000 |
| TG1103    | ICT1153 |        6.6000000 |
| TG1104    | ICT1153 |        4.4000000 |
| TG1350    | ICT1161 |       34.6000000 |
| TG1351    | ICT1161 |       32.6000000 |
| TG1352    | ICT1161 |       31.5000000 |
| TG1353    | ICT1161 |       33.9000000 |
| TG1354    | ICT1161 |       33.2000000 |
| TG1355    | ICT1161 |       32.6000000 |
| TG1356    | ICT1161 |       30.2000000 |
| TG1357    | ICT1161 |       34.5000000 |
| TG1358    | ICT1161 |       32.6000000 |
| TG1359    | ICT1161 |       31.0000000 |
| TG1100    | ICT1161 |       16.2000000 |
| TG1101    | ICT1161 |       13.5000000 |
| TG1102    | ICT1161 |       11.0000000 |
| TG1103    | ICT1161 |        9.5000000 |
| TG1104    | ICT1161 |        8.5000000 |
| TG1350    | ICT1142 |       35.8000000 |
| TG1351    | ICT1142 |       31.0000000 |
| TG1352    | ICT1142 |       27.0000000 |
| TG1353    | ICT1142 |       31.6000000 |
| TG1354    | ICT1142 |       34.4000000 |
| TG1355    | ICT1142 |       32.4000000 |
| TG1356    | ICT1142 |       29.0000000 |
| TG1357    | ICT1142 |       34.4000000 |
| TG1358    | ICT1142 |       31.0000000 |
| TG1359    | ICT1142 |       30.4000000 |
| TG1100    | ICT1142 |       13.0000000 |
| TG1101    | ICT1142 |       11.0000000 |
| TG1102    | ICT1142 |        9.0000000 |
| TG1103    | ICT1142 |        6.6000000 |
| TG1104    | ICT1142 |        4.4000000 |
| TG1350    | ICT1212 |       36.1000000 |
| TG1351    | ICT1212 |       34.9000000 |
| TG1352    | ICT1212 |       33.3000000 |
| TG1353    | ICT1212 |       33.9000000 |
| TG1354    | ICT1212 |       35.0000000 |
| TG1355    | ICT1212 |       34.1000000 |
| TG1356    | ICT1212 |       33.3000000 |
| TG1357    | ICT1212 |       35.3000000 |
| TG1358    | ICT1212 |       32.4000000 |
| TG1359    | ICT1212 |       31.7000000 |
| TG1100    | ICT1212 |       15.5000000 |
| TG1101    | ICT1212 |       14.2000000 |
| TG1102    | ICT1212 |       12.4000000 |
| TG1103    | ICT1212 |       10.9000000 |
| TG1104    | ICT1212 |        9.2000000 |
| TG1350    | TMS1233 |       33.8000000 |
| TG1351    | TMS1233 |       34.4000000 |
| TG1352    | TMS1233 |       34.3000000 |
| TG1353    | TMS1233 |       33.7000000 |
| TG1354    | TMS1233 |       34.9000000 |
| TG1355    | TMS1233 |       32.2000000 |
| TG1356    | TMS1233 |       34.4000000 |
| TG1357    | TMS1233 |       33.1000000 |
| TG1358    | TMS1233 |       35.0000000 |
| TG1359    | TMS1233 |       33.7000000 |
| TG1100    | TMS1233 |       13.1000000 |
| TG1101    | TMS1233 |       11.8000000 |
| TG1102    | TMS1233 |       10.7000000 |
| TG1103    | TMS1233 |        8.6000000 |
| TG1104    | TMS1233 |        7.9000000 |
| TG1350    | ENG1222 |       36.1000000 |
| TG1351    | ENG1222 |       35.4000000 |
| TG1352    | ENG1222 |       34.5000000 |
| TG1353    | ENG1222 |       33.9000000 |
| TG1354    | ENG1222 |       35.7000000 |
| TG1355    | ENG1222 |       34.3000000 |
| TG1356    | ENG1222 |       35.1000000 |
| TG1357    | ENG1222 |       33.8000000 |
| TG1358    | ENG1222 |       35.1000000 |
| TG1359    | ENG1222 |       34.3000000 |
| TG1100    | ENG1222 |       11.0000000 |
| TG1101    | ENG1222 |       11.5000000 |
| TG1102    | ENG1222 |       13.0000000 |
| TG1103    | ENG1222 |       11.3000000 |
| TG1104    | ENG1222 |       10.6000000 |
| TG1350    | TCS1212 |       36.1000000 |
| TG1351    | TCS1212 |       34.9000000 |
| TG1352    | TCS1212 |       34.7000000 |
| TG1353    | TCS1212 |       33.7000000 |
| TG1354    | TCS1212 |       35.7000000 |
| TG1355    | TCS1212 |       34.6000000 |
| TG1356    | TCS1212 |       34.8000000 |
| TG1357    | TCS1212 |       33.7000000 |
| TG1358    | TCS1212 |       35.2000000 |
| TG1359    | TCS1212 |       33.4000000 |
| TG1100    | TCS1212 |       11.4000000 |
| TG1101    | TCS1212 |       11.4000000 |
| TG1102    | TCS1212 |       11.2000000 |
| TG1103    | TCS1212 |       10.5000000 |
| TG1104    | TCS1212 |       10.8000000 |
| TG1350    | ICT1233 |       36.1333332 |
| TG1351    | ICT1233 |       35.4666668 |
| TG1352    | ICT1233 |       34.9333332 |
| TG1353    | ICT1233 |       34.6666668 |
| TG1354    | ICT1233 |       36.0000000 |
| TG1355    | ICT1233 |       34.9333332 |
| TG1356    | ICT1233 |       34.8000000 |
| TG1357    | ICT1233 |       34.5333332 |
| TG1358    | ICT1233 |       35.8666668 |
| TG1359    | ICT1233 |       34.5333332 |
| TG1100    | ICT1233 |       11.0666668 |
| TG1101    | ICT1233 |       12.0000000 |
| TG1102    | ICT1233 |       11.0666668 |
| TG1103    | ICT1233 |       10.6666668 |
| TG1104    | ICT1233 |       10.8000000 |
| TG1350    | ICT1242 |       36.1000000 |
| TG1351    | ICT1242 |       35.0000000 |
| TG1352    | ICT1242 |       34.5000000 |
| TG1353    | ICT1242 |       36.6000000 |
| TG1354    | ICT1242 |       34.3000000 |
| TG1355    | ICT1242 |       32.6000000 |
| TG1356    | ICT1242 |       30.9000000 |
| TG1357    | ICT1242 |       29.6000000 |
| TG1358    | ICT1242 |       29.8000000 |
| TG1359    | ICT1242 |       28.8000000 |
| TG1100    | ICT1242 |       11.2000000 |
| TG1101    | ICT1242 |       11.5000000 |
| TG1102    | ICT1242 |       11.2000000 |
| TG1103    | ICT1242 |       10.5000000 |
| TG1104    | ICT1242 |       10.6000000 |
| TG1350    | ICT1253 |       36.1333332 |
| TG1351    | ICT1253 |       35.8666668 |
| TG1352    | ICT1253 |       33.8666668 |
| TG1353    | ICT1253 |       36.0000000 |
| TG1354    | ICT1253 |       34.4000000 |
| TG1355    | ICT1253 |       34.4000000 |
| TG1356    | ICT1253 |       36.4000000 |
| TG1357    | ICT1253 |       34.9333332 |
| TG1358    | ICT1253 |       36.2666668 |
| TG1359    | ICT1253 |       36.8000000 |
| TG1100    | ICT1253 |       11.6000000 |
| TG1101    | ICT1253 |       11.6000000 |
| TG1102    | ICT1253 |       12.6666668 |
| TG1103    | ICT1253 |       10.9333332 |
| TG1104    | ICT1253 |        8.8000000 |
+-----------+---------+------------------+
225 rows in set (0.00 sec)

mysql>

----------------------------------------------------------------------
2 . Check Eligibility Based on CA Marks
----------------------------------------------------------------------

/////////////////////////////////
Code
////////////////////////////////

CREATE VIEW Eligibility_Check AS
SELECT 
    StudentID, 
    Sub_ID, 
    CA_40_Percentage,
    CASE 
        WHEN CA_40_Percentage > 20 THEN 'Eligible'
        ELSE 'Not Eligible'
    END AS Eligibility_Status
FROM 
    CA_40_Percentage;


--------------------------------------------------------------------------
SELECT 
    StudentID, 
    CA_40_Percentage, 
    Eligibility_Status 
FROM 
    Eligibility_Check;
---------------------------------------------------------------------------


////////////////////////////////
Output
///////////////////////////////

mysql> CREATE VIEW Eligibility_Check AS
    -> SELECT
    ->     StudentID,
    ->     Sub_ID,
    ->     CA_40_Percentage,
    ->     CASE
    ->         WHEN CA_40_Percentage > 20 THEN 'Eligible'
    ->         ELSE 'Not Eligible'
    ->     END AS Eligibility_Status
    -> FROM
    ->     CA_40_Percentage;
Query OK, 0 rows affected (0.02 sec)

mysql> SELECT
    ->     StudentID,
    ->     CA_40_Percentage,
    ->     Eligibility_Status
    -> FROM
    ->     Eligibility_Check;
+-----------+------------------+--------------------+
| StudentID | CA_40_Percentage | Eligibility_Status |
+-----------+------------------+--------------------+
| TG1350    |       35.7000000 | Eligible           |
| TG1351    |       31.9000000 | Eligible           |
| TG1352    |       35.4000000 | Eligible           |
| TG1353    |       33.2000000 | Eligible           |
| TG1354    |       36.7000000 | Eligible           |
| TG1355    |       29.8000000 | Eligible           |
| TG1356    |       32.6000000 | Eligible           |
| TG1357    |       28.3000000 | Eligible           |
| TG1358    |       28.4000000 | Eligible           |
| TG1359    |       37.1000000 | Eligible           |
| TG1100    |       21.0000000 | Eligible           |
| TG1101    |       23.6000000 | Eligible           |
| TG1102    |       19.3000000 | Not Eligible       |
| TG1103    |       15.3000000 | Not Eligible       |
| TG1104    |       12.3000000 | Not Eligible       |
| TG1350    |       35.8666668 | Eligible           |
| TG1351    |       28.4000000 | Eligible           |
| TG1352    |       33.3333332 | Eligible           |
| TG1353    |       30.5333332 | Eligible           |
| TG1354    |       36.2666668 | Eligible           |
| TG1355    |       23.2000000 | Eligible           |
| TG1356    |       26.4000000 | Eligible           |
| TG1357    |       21.4666668 | Eligible           |
| TG1358    |       27.8666668 | Eligible           |
| TG1359    |       32.4000000 | Eligible           |
| TG1100    |       16.6666668 | Not Eligible       |
| TG1101    |       20.8000000 | Eligible           |
| TG1102    |       15.0666668 | Not Eligible       |
| TG1103    |       11.3333332 | Not Eligible       |
| TG1104    |        8.1333332 | Not Eligible       |
| TG1350    |       35.5000000 | Eligible           |
| TG1351    |       30.9000000 | Eligible           |
| TG1352    |       35.0000000 | Eligible           |
| TG1353    |       25.1000000 | Eligible           |
| TG1354    |       33.0000000 | Eligible           |
| TG1355    |       16.8000000 | Not Eligible       |
| TG1356    |       21.0000000 | Eligible           |
| TG1357    |       18.9000000 | Not Eligible       |
| TG1358    |       28.1000000 | Eligible           |
| TG1359    |       32.7000000 | Eligible           |
| TG1100    |       11.2000000 | Not Eligible       |
| TG1101    |       21.1000000 | Eligible           |
| TG1102    |       15.3000000 | Not Eligible       |
| TG1103    |       11.0000000 | Not Eligible       |
| TG1104    |        7.9000000 | Not Eligible       |
| TG1350    |       35.9000000 | Eligible           |
| TG1351    |       31.3000000 | Eligible           |
| TG1352    |       34.9000000 | Eligible           |
| TG1353    |       25.2000000 | Eligible           |
| TG1354    |       31.6000000 | Eligible           |
| TG1355    |       16.4000000 | Not Eligible       |
| TG1356    |       21.7000000 | Eligible           |
| TG1357    |       16.6000000 | Not Eligible       |
| TG1358    |       28.8000000 | Eligible           |
| TG1359    |       32.6000000 | Eligible           |
| TG1100    |       10.1000000 | Not Eligible       |
| TG1101    |       18.8000000 | Not Eligible       |
| TG1102    |       13.7000000 | Not Eligible       |
| TG1103    |       11.6000000 | Not Eligible       |
| TG1104    |        9.0000000 | Not Eligible       |
| TG1350    |       36.1000000 | Eligible           |
| TG1351    |       30.4000000 | Eligible           |
| TG1352    |       34.4000000 | Eligible           |
| TG1353    |       25.1000000 | Eligible           |
| TG1354    |       32.4000000 | Eligible           |
| TG1355    |       17.0000000 | Not Eligible       |
| TG1356    |       21.2000000 | Eligible           |
| TG1357    |       16.4000000 | Not Eligible       |
| TG1358    |       30.0000000 | Eligible           |
| TG1359    |       33.0000000 | Eligible           |
| TG1100    |       11.0000000 | Not Eligible       |
| TG1101    |       18.2000000 | Not Eligible       |
| TG1102    |       13.8000000 | Not Eligible       |
| TG1103    |       11.5000000 | Not Eligible       |
| TG1104    |        8.5000000 | Not Eligible       |
| TG1350    |       34.4000000 | Eligible           |
| TG1351    |       31.0000000 | Eligible           |
| TG1352    |       27.0000000 | Eligible           |
| TG1353    |       31.6000000 | Eligible           |
| TG1354    |       34.4000000 | Eligible           |
| TG1355    |       32.4000000 | Eligible           |
| TG1356    |       29.0000000 | Eligible           |
| TG1357    |       34.4000000 | Eligible           |
| TG1358    |       31.0000000 | Eligible           |
| TG1359    |       30.4000000 | Eligible           |
| TG1100    |       13.0000000 | Not Eligible       |
| TG1101    |       11.0000000 | Not Eligible       |
| TG1102    |        9.0000000 | Not Eligible       |
| TG1103    |        6.6000000 | Not Eligible       |
| TG1104    |        4.4000000 | Not Eligible       |
| TG1350    |       34.6000000 | Eligible           |
| TG1351    |       32.6000000 | Eligible           |
| TG1352    |       31.5000000 | Eligible           |
| TG1353    |       33.9000000 | Eligible           |
| TG1354    |       33.2000000 | Eligible           |
| TG1355    |       32.6000000 | Eligible           |
| TG1356    |       30.2000000 | Eligible           |
| TG1357    |       34.5000000 | Eligible           |
| TG1358    |       32.6000000 | Eligible           |
| TG1359    |       31.0000000 | Eligible           |
| TG1100    |       16.2000000 | Not Eligible       |
| TG1101    |       13.5000000 | Not Eligible       |
| TG1102    |       11.0000000 | Not Eligible       |
| TG1103    |        9.5000000 | Not Eligible       |
| TG1104    |        8.5000000 | Not Eligible       |
| TG1350    |       35.8000000 | Eligible           |
| TG1351    |       31.0000000 | Eligible           |
| TG1352    |       27.0000000 | Eligible           |
| TG1353    |       31.6000000 | Eligible           |
| TG1354    |       34.4000000 | Eligible           |
| TG1355    |       32.4000000 | Eligible           |
| TG1356    |       29.0000000 | Eligible           |
| TG1357    |       34.4000000 | Eligible           |
| TG1358    |       31.0000000 | Eligible           |
| TG1359    |       30.4000000 | Eligible           |
| TG1100    |       13.0000000 | Not Eligible       |
| TG1101    |       11.0000000 | Not Eligible       |
| TG1102    |        9.0000000 | Not Eligible       |
| TG1103    |        6.6000000 | Not Eligible       |
| TG1104    |        4.4000000 | Not Eligible       |
| TG1350    |       36.1000000 | Eligible           |
| TG1351    |       34.9000000 | Eligible           |
| TG1352    |       33.3000000 | Eligible           |
| TG1353    |       33.9000000 | Eligible           |
| TG1354    |       35.0000000 | Eligible           |
| TG1355    |       34.1000000 | Eligible           |
| TG1356    |       33.3000000 | Eligible           |
| TG1357    |       35.3000000 | Eligible           |
| TG1358    |       32.4000000 | Eligible           |
| TG1359    |       31.7000000 | Eligible           |
| TG1100    |       15.5000000 | Not Eligible       |
| TG1101    |       14.2000000 | Not Eligible       |
| TG1102    |       12.4000000 | Not Eligible       |
| TG1103    |       10.9000000 | Not Eligible       |
| TG1104    |        9.2000000 | Not Eligible       |
| TG1350    |       33.8000000 | Eligible           |
| TG1351    |       34.4000000 | Eligible           |
| TG1352    |       34.3000000 | Eligible           |
| TG1353    |       33.7000000 | Eligible           |
| TG1354    |       34.9000000 | Eligible           |
| TG1355    |       32.2000000 | Eligible           |
| TG1356    |       34.4000000 | Eligible           |
| TG1357    |       33.1000000 | Eligible           |
| TG1358    |       35.0000000 | Eligible           |
| TG1359    |       33.7000000 | Eligible           |
| TG1100    |       13.1000000 | Not Eligible       |
| TG1101    |       11.8000000 | Not Eligible       |
| TG1102    |       10.7000000 | Not Eligible       |
| TG1103    |        8.6000000 | Not Eligible       |
| TG1104    |        7.9000000 | Not Eligible       |
| TG1350    |       36.1000000 | Eligible           |
| TG1351    |       35.4000000 | Eligible           |
| TG1352    |       34.5000000 | Eligible           |
| TG1353    |       33.9000000 | Eligible           |
| TG1354    |       35.7000000 | Eligible           |
| TG1355    |       34.3000000 | Eligible           |
| TG1356    |       35.1000000 | Eligible           |
| TG1357    |       33.8000000 | Eligible           |
| TG1358    |       35.1000000 | Eligible           |
| TG1359    |       34.3000000 | Eligible           |
| TG1100    |       11.0000000 | Not Eligible       |
| TG1101    |       11.5000000 | Not Eligible       |
| TG1102    |       13.0000000 | Not Eligible       |
| TG1103    |       11.3000000 | Not Eligible       |
| TG1104    |       10.6000000 | Not Eligible       |
| TG1350    |       36.1000000 | Eligible           |
| TG1351    |       34.9000000 | Eligible           |
| TG1352    |       34.7000000 | Eligible           |
| TG1353    |       33.7000000 | Eligible           |
| TG1354    |       35.7000000 | Eligible           |
| TG1355    |       34.6000000 | Eligible           |
| TG1356    |       34.8000000 | Eligible           |
| TG1357    |       33.7000000 | Eligible           |
| TG1358    |       35.2000000 | Eligible           |
| TG1359    |       33.4000000 | Eligible           |
| TG1100    |       11.4000000 | Not Eligible       |
| TG1101    |       11.4000000 | Not Eligible       |
| TG1102    |       11.2000000 | Not Eligible       |
| TG1103    |       10.5000000 | Not Eligible       |
| TG1104    |       10.8000000 | Not Eligible       |
| TG1350    |       36.1333332 | Eligible           |
| TG1351    |       35.4666668 | Eligible           |
| TG1352    |       34.9333332 | Eligible           |
| TG1353    |       34.6666668 | Eligible           |
| TG1354    |       36.0000000 | Eligible           |
| TG1355    |       34.9333332 | Eligible           |
| TG1356    |       34.8000000 | Eligible           |
| TG1357    |       34.5333332 | Eligible           |
| TG1358    |       35.8666668 | Eligible           |
| TG1359    |       34.5333332 | Eligible           |
| TG1100    |       11.0666668 | Not Eligible       |
| TG1101    |       12.0000000 | Not Eligible       |
| TG1102    |       11.0666668 | Not Eligible       |
| TG1103    |       10.6666668 | Not Eligible       |
| TG1104    |       10.8000000 | Not Eligible       |
| TG1350    |       36.1000000 | Eligible           |
| TG1351    |       35.0000000 | Eligible           |
| TG1352    |       34.5000000 | Eligible           |
| TG1353    |       36.6000000 | Eligible           |
| TG1354    |       34.3000000 | Eligible           |
| TG1355    |       32.6000000 | Eligible           |
| TG1356    |       30.9000000 | Eligible           |
| TG1357    |       29.6000000 | Eligible           |
| TG1358    |       29.8000000 | Eligible           |
| TG1359    |       28.8000000 | Eligible           |
| TG1100    |       11.2000000 | Not Eligible       |
| TG1101    |       11.5000000 | Not Eligible       |
| TG1102    |       11.2000000 | Not Eligible       |
| TG1103    |       10.5000000 | Not Eligible       |
| TG1104    |       10.6000000 | Not Eligible       |
| TG1350    |       36.1333332 | Eligible           |
| TG1351    |       35.8666668 | Eligible           |
| TG1352    |       33.8666668 | Eligible           |
| TG1353    |       36.0000000 | Eligible           |
| TG1354    |       34.4000000 | Eligible           |
| TG1355    |       34.4000000 | Eligible           |
| TG1356    |       36.4000000 | Eligible           |
| TG1357    |       34.9333332 | Eligible           |
| TG1358    |       36.2666668 | Eligible           |
| TG1359    |       36.8000000 | Eligible           |
| TG1100    |       11.6000000 | Not Eligible       |
| TG1101    |       11.6000000 | Not Eligible       |
| TG1102    |       12.6666668 | Not Eligible       |
| TG1103    |       10.9333332 | Not Eligible       |
| TG1104    |        8.8000000 | Not Eligible       |
+-----------+------------------+--------------------+
225 rows in set (0.02 sec)



-------------------------------------------------------------------------------------
3. View CA Marks Summary by Course Code for the Whole Batch
--------------------------------------------------------------------------------------


//////////////////////////////////////
Code
/////////////////////////////////////

CREATE VIEW CA_Marks_Summary AS
SELECT 
    sc.Course_Code,
    AVG(cp.CA_40_Percentage) AS Avg_CA_40_Percentage,
    MIN(cp.CA_40_Percentage) AS Min_CA_40_Percentage,
    MAX(cp.CA_40_Percentage) AS Max_CA_40_Percentage,
    COUNT(cp.StudentID) AS Student_Count
FROM 
    Student_course sc
JOIN 
    CA_40_Percentage cp ON sc.Reg_No = cp.StudentID
GROUP BY 
    sc.Course_Code;

----------------------------------------------------------------------------------------
SELECT * 
FROM CA_Marks_Summary
WHERE Course_Code = 'C01';
----------------------------------------------------------------------------------------


/////////////////////////////////////////////////
Output
/////////////////////////////////////////////////

mysql> CREATE VIEW CA_Marks_Summary AS
    -> SELECT
    ->     sc.Course_Code,
    ->     AVG(cp.CA_40_Percentage) AS Avg_CA_40_Percentage,
    ->     MIN(cp.CA_40_Percentage) AS Min_CA_40_Percentage,
    ->     MAX(cp.CA_40_Percentage) AS Max_CA_40_Percentage,
    ->     COUNT(cp.StudentID) AS Student_Count
    -> FROM
    ->     Student_course sc
    -> JOIN
    ->     CA_40_Percentage cp ON sc.Reg_No = cp.StudentID
    -> GROUP BY
    ->     sc.Course_Code;
Query OK, 0 rows affected (0.02 sec)

mysql> SELECT *
    -> FROM CA_Marks_Summary
    -> WHERE Course_Code = 'C01';
+-------------+----------------------+----------------------+----------------------+---------------+
| Course_Code | Avg_CA_40_Percentage | Min_CA_40_Percentage | Max_CA_40_Percentage | Student_Count |
+-------------+----------------------+----------------------+----------------------+---------------+
| C01         |       25.41274074311 |            4.4000000 |           37.1000000 |           225 |
+-------------+----------------------+----------------------+----------------------+---------------+
1 row in set (0.02 sec)











mysql> CREATE VIEW CA_Marks_Summary AS
    -> SELECT
    ->     sc.Course_Code,
    ->     AVG(cp.CA_40_Percentage) AS Avg_CA_40_Percentage,
    ->     MIN(cp.CA_40_Percentage) AS Min_CA_40_Percentage,
    ->     MAX(cp.CA_40_Percentage) AS Max_CA_40_Percentage,
    ->     COUNT(cp.StudentID) AS Student_Count
    -> FROM
    ->     Student_course sc
    -> JOIN
    ->     CA_40_Percentage cp ON sc.Reg_No = cp.StudentID
    -> GROUP BY
    ->     sc.Course_Code;
Query OK, 0 rows affected (0.02 sec)

mysql> SELECT *
    -> FROM CA_Marks_Summary
    -> WHERE Course_Code = 'C01';
+-------------+----------------------+----------------------+----------------------+---------------+
| Course_Code | Avg_CA_40_Percentage | Min_CA_40_Percentage | Max_CA_40_Percentage | Student_Count |
+-------------+----------------------+----------------------+----------------------+---------------+
| C01         |       25.41274074311 |            4.4000000 |           37.1000000 |           225 |
+-------------+----------------------+----------------------+----------------------+---------------+
1 row in set (0.02 sec)


----------------------------------------------------------------------------------------------
4. View CA Marks Summary for Individual Students and check the eligibility
----------------------------------------------------------------------------------------------
///////////////////////
Code
///////////////////////

CREATE VIEW Student_CA_Marks_Eligibility AS
SELECT 
    StudentID,
    Sub_ID,
    SUM(CA_40_Percentage) AS Total_CA_Marks,
    CASE 
        WHEN SUM(CA_40_Percentage) > 20 THEN 'Eligible'
        ELSE 'Not Eligible'
    END AS Eligibility_Status
FROM CA_40_Percentage
GROUP BY StudentID, Sub_ID;



----------------------------------------------------------------------------------
SELECT StudentID, Sub_ID, Avg_CA_Marks
FROM Student_CA_Marks_Summary
WHERE StudentID = 'TG1350'; 
--------------------------------------------------------------------------------


/////////////////////
Output
/////////////////////


mysql> CREATE VIEW Student_CA_Marks_Eligibility AS
    -> SELECT
    ->     StudentID,
    ->     Sub_ID,
    ->     SUM(CA_40_Percentage) AS Total_CA_Marks, 
    ->     CASE
    ->         WHEN SUM(CA_40_Percentage) > 20 THEN 'Eligible'
    ->         ELSE 'Not Eligible'
    ->     END AS Eligibility_Status
    -> FROM CA_40_Percentage
    -> GROUP BY StudentID, Sub_ID;
Query OK, 0 rows affected (0.02 sec)

mysql> SELECT StudentID, Sub_ID, Avg_CA_Marks
    -> FROM Student_CA_Marks_Summary
    -> WHERE StudentID = 'TG1350';
+-----------+---------+----------------+
| StudentID | Sub_ID  | Avg_CA_Marks   |
+-----------+---------+----------------+
| TG1350    | ICT1112 | 35.70000000000 |
| TG1350    | TMS1113 | 35.86666680000 |
| TG1350    | ENG1114 | 35.50000000000 |
| TG1350    | ICT1122 | 35.90000000000 |
| TG1350    | ICT1132 | 36.10000000000 |
| TG1350    | ICT1153 | 34.40000000000 |
| TG1350    | ICT1161 | 34.60000000000 |
| TG1350    | ICT1142 | 35.80000000000 |
| TG1350    | ICT1212 | 36.10000000000 |
| TG1350    | TMS1233 | 33.80000000000 |
| TG1350    | ENG1222 | 36.10000000000 |
| TG1350    | TCS1212 | 36.10000000000 |
| TG1350    | ICT1233 | 36.13333320000 |
| TG1350    | ICT1242 | 36.10000000000 |
| TG1350    | ICT1253 | 36.13333320000 |
+-----------+---------+----------------+
15 rows in set (0.00 sec)




--------------------------------
Final Marks
--------------------------------

/////////////
Code
///////////

-- Step 1: Calculate Final Marks Separately for Each Subject
CREATE OR REPLACE VIEW Eligible_Student_Subject_Final_Marks AS
SELECT 
    e.StudentID,
    e.Sub_ID,
    e.Total_CA_Marks * 0.4 AS CA_40_Percentage,
    COALESCE(t.MarksObtained * 0.3, 0) AS Final_Theory_30,
    COALESCE(p.MarksObtained * 0.3, 0) AS Final_Practical_30,
    LEAST((e.Total_CA_Marks * 0.4 + COALESCE(t.MarksObtained * 0.3, 0) + COALESCE(p.MarksObtained * 0.3, 0)), 100) AS Final_Mark
FROM 
    student_ca_marks_eligibility e
LEFT JOIN 
    marks t ON e.StudentID = t.StudentID AND e.Sub_ID = t.Sub_ID AND t.AssessmentType = 'Final_Theory'
LEFT JOIN 
    marks p ON e.StudentID = p.StudentID AND e.Sub_ID = p.Sub_ID AND p.AssessmentType = 'Final_Practical'
WHERE 
    e.Eligibility_Status = 'Eligible';

-- Step 2: Query Final Marks Separately by Subject and Student
SELECT 
    StudentID,
    Sub_ID,
    Final_Mark
FROM 
    Eligible_Student_Subject_Final_Marks
ORDER BY 
    StudentID, Sub_ID;


mysql> SELECT
    ->     StudentID,
    ->     Sub_ID,
    ->     Final_Mark
    -> FROM
    ->     Eligible_Student_Subject_Final_Marks
    -> ORDER BY
    ->     StudentID, Sub_ID;
+-----------+---------+-------------+
| StudentID | Sub_ID  | Final_Mark  |
+-----------+---------+-------------+
| TG1100    | ICT1112 | 41.40000000 |
| TG1101    | ENG1114 | 24.94000000 |
| TG1101    | ICT1112 | 46.34000000 |
| TG1101    | TMS1113 |  8.32000000 |
| TG1350    | ENG1114 | 40.60000000 |
| TG1350    | ENG1222 | 42.04000000 |
| TG1350    | ICT1112 | 70.08000000 |
| TG1350    | ICT1122 | 65.96000000 |
| TG1350    | ICT1132 | 68.74000000 |
| TG1350    | ICT1142 | 41.02000000 |
| TG1350    | ICT1153 | 39.26000000 |
| TG1350    | ICT1153 | 39.26000000 |
| TG1350    | ICT1161 | 41.44000000 |
| TG1350    | ICT1161 | 41.44000000 |
| TG1350    | ICT1212 | 42.04000000 |
| TG1350    | ICT1233 | 68.75333328 |
| TG1350    | ICT1242 | 42.04000000 |
| TG1350    | ICT1253 | 68.75333328 |
| TG1350    | TCS1212 | 42.04000000 |
| TG1350    | TMS1113 | 14.34666672 |
| TG1350    | TMS1233 | 39.02000000 |
| TG1351    | ENG1114 | 36.36000000 |
| TG1351    | ENG1222 | 41.46000000 |
| TG1351    | ICT1112 | 61.96000000 |
| TG1351    | ICT1122 | 57.82000000 |
| TG1351    | ICT1132 | 57.16000000 |
| TG1351    | ICT1142 | 37.00000000 |
| TG1351    | ICT1153 | 37.00000000 |
| TG1351    | ICT1153 | 37.00000000 |
| TG1351    | ICT1161 | 39.44000000 |
| TG1351    | ICT1161 | 39.44000000 |
| TG1351    | ICT1212 | 40.66000000 |
| TG1351    | ICT1233 | 67.58666672 |
| TG1351    | ICT1242 | 40.40000000 |
| TG1351    | ICT1253 | 67.74666672 |
| TG1351    | TCS1212 | 40.66000000 |
| TG1351    | TMS1113 | 11.36000000 |
| TG1351    | TMS1233 | 39.86000000 |
| TG1352    | ENG1114 | 39.50000000 |
| TG1352    | ENG1222 | 40.50000000 |
| TG1352    | ICT1112 | 66.96000000 |
| TG1352    | ICT1122 | 64.36000000 |
| TG1352    | ICT1132 | 66.86000000 |
| TG1352    | ICT1142 | 32.40000000 |
| TG1352    | ICT1153 | 32.40000000 |
| TG1352    | ICT1153 | 32.40000000 |
| TG1352    | ICT1161 | 38.10000000 |
| TG1352    | ICT1161 | 38.10000000 |
| TG1352    | ICT1212 | 39.12000000 |
| TG1352    | ICT1233 | 66.47333328 |
| TG1352    | ICT1242 | 39.90000000 |
| TG1352    | ICT1253 | 66.04666672 |
| TG1352    | TCS1212 | 40.28000000 |
| TG1352    | TMS1113 | 13.33333328 |
| TG1352    | TMS1233 | 40.42000000 |
| TG1353    | ENG1114 | 28.64000000 |
| TG1353    | ENG1222 | 39.66000000 |
| TG1353    | ICT1112 | 64.58000000 |
| TG1353    | ICT1122 | 47.58000000 |
| TG1353    | ICT1132 | 48.74000000 |
| TG1353    | ICT1142 | 36.94000000 |
| TG1353    | ICT1153 | 36.94000000 |
| TG1353    | ICT1153 | 36.94000000 |
| TG1353    | ICT1161 | 40.26000000 |
| TG1353    | ICT1161 | 40.26000000 |
| TG1353    | ICT1212 | 38.76000000 |
| TG1353    | ICT1233 | 65.16666672 |
| TG1353    | ICT1242 | 42.54000000 |
| TG1353    | ICT1253 | 69.00000000 |
| TG1353    | TCS1212 | 39.28000000 |
| TG1353    | TMS1113 | 12.21333328 |
| TG1353    | TMS1233 | 39.28000000 |
| TG1354    | ENG1114 | 37.50000000 |
| TG1354    | ENG1222 | 41.58000000 |
| TG1354    | ICT1112 | 71.68000000 |
| TG1354    | ICT1122 | 59.14000000 |
| TG1354    | ICT1132 | 63.06000000 |
| TG1354    | ICT1142 | 40.76000000 |
| TG1354    | ICT1153 | 40.76000000 |
| TG1354    | ICT1153 | 40.76000000 |
| TG1354    | ICT1161 | 38.48000000 |
| TG1354    | ICT1161 | 38.48000000 |
| TG1354    | ICT1212 | 40.40000000 |
| TG1354    | ICT1233 | 67.80000000 |
| TG1354    | ICT1242 | 40.12000000 |
| TG1354    | ICT1253 | 65.66000000 |
| TG1354    | TCS1212 | 41.58000000 |
| TG1354    | TMS1113 | 14.50666672 |
| TG1354    | TMS1233 | 40.36000000 |
| TG1355    | ENG1222 | 39.52000000 |
| TG1355    | ICT1112 | 59.02000000 |
| TG1355    | ICT1142 | 38.46000000 |
| TG1355    | ICT1153 | 38.46000000 |
| TG1355    | ICT1153 | 38.46000000 |
| TG1355    | ICT1161 | 38.84000000 |
| TG1355    | ICT1161 | 38.84000000 |
| TG1355    | ICT1212 | 39.74000000 |
| TG1355    | ICT1233 | 66.47333328 |
| TG1355    | ICT1242 | 37.04000000 |
| TG1355    | ICT1253 | 65.66000000 |
| TG1355    | TCS1212 | 40.24000000 |
| TG1355    | TMS1113 |  9.28000000 |
| TG1355    | TMS1233 | 37.78000000 |
| TG1356    | ENG1114 | 23.40000000 |
| TG1356    | ENG1222 | 41.04000000 |
| TG1356    | ICT1112 | 62.54000000 |
| TG1356    | ICT1122 | 39.58000000 |
| TG1356    | ICT1132 | 38.78000000 |
| TG1356    | ICT1142 | 35.00000000 |
| TG1356    | ICT1153 | 35.00000000 |
| TG1356    | ICT1153 | 35.00000000 |
| TG1356    | ICT1161 | 36.08000000 |
| TG1356    | ICT1161 | 36.08000000 |
| TG1356    | ICT1212 | 38.82000000 |
| TG1356    | ICT1233 | 66.42000000 |
| TG1356    | ICT1242 | 35.16000000 |
| TG1356    | ICT1253 | 68.86000000 |
| TG1356    | TCS1212 | 40.02000000 |
| TG1356    | TMS1113 | 10.56000000 |
| TG1356    | TMS1233 | 39.86000000 |
| TG1357    | ENG1222 | 39.92000000 |
| TG1357    | ICT1112 | 53.92000000 |
| TG1357    | ICT1142 | 40.16000000 |
| TG1357    | ICT1153 | 40.16000000 |
| TG1357    | ICT1153 | 40.16000000 |
| TG1357    | ICT1161 | 40.20000000 |
| TG1357    | ICT1161 | 40.20000000 |
| TG1357    | ICT1212 | 41.12000000 |
| TG1357    | ICT1233 | 65.11333328 |
| TG1357    | ICT1242 | 33.44000000 |
| TG1357    | ICT1253 | 65.57333328 |
| TG1357    | TCS1212 | 39.28000000 |
| TG1357    | TMS1113 |  8.58666672 |
| TG1357    | TMS1233 | 38.74000000 |
| TG1358    | ENG1114 | 32.84000000 |
| TG1358    | ENG1222 | 41.04000000 |
| TG1358    | ICT1112 | 55.16000000 |
| TG1358    | ICT1122 | 55.02000000 |
| TG1358    | ICT1132 | 57.30000000 |
| TG1358    | ICT1142 | 36.40000000 |
| TG1358    | ICT1153 | 36.40000000 |
| TG1358    | ICT1153 | 36.40000000 |
| TG1358    | ICT1161 | 38.54000000 |
| TG1358    | ICT1161 | 38.54000000 |
| TG1358    | ICT1212 | 37.26000000 |
| TG1358    | ICT1233 | 67.74666672 |
| TG1358    | ICT1242 | 33.82000000 |
| TG1358    | ICT1253 | 68.80666672 |
| TG1358    | TCS1212 | 40.78000000 |
| TG1358    | TMS1113 | 11.14666672 |
| TG1358    | TMS1233 | 40.40000000 |
| TG1359    | ENG1114 | 38.28000000 |
| TG1359    | ENG1222 | 40.42000000 |
| TG1359    | ICT1112 | 71.84000000 |
| TG1359    | ICT1122 | 61.04000000 |
| TG1359    | ICT1132 | 63.90000000 |
| TG1359    | ICT1142 | 36.76000000 |
| TG1359    | ICT1153 | 36.76000000 |
| TG1359    | ICT1153 | 36.76000000 |
| TG1359    | ICT1161 | 36.70000000 |
| TG1359    | ICT1161 | 36.70000000 |
| TG1359    | ICT1212 | 37.28000000 |
| TG1359    | ICT1233 | 65.71333328 |
| TG1359    | ICT1242 | 31.92000000 |
| TG1359    | ICT1253 | 69.32000000 |
| TG1359    | TCS1212 | 38.56000000 |
| TG1359    | TMS1113 | 12.96000000 |
| TG1359    | TMS1233 | 38.98000000 |
+-----------+---------+-------------+
168 rows in set (0.04 sec)



-------------------------------------------------------------------------
Get the Grade
--------------------------------------------------------------------------


-- Create or Replace View for Grades, GPV, and Attainment
CREATE OR REPLACE VIEW Eligible_Student_Grades AS
SELECT 
    StudentID,
    Sub_ID,
    Final_Mark,
    CASE 
        WHEN Final_Mark >= 85 THEN 'A+'
        WHEN Final_Mark >= 70 THEN 'A'
        WHEN Final_Mark >= 65 THEN 'A-'
        WHEN Final_Mark >= 60 THEN 'B+'
        WHEN Final_Mark >= 55 THEN 'B'
        WHEN Final_Mark >= 50 THEN 'B-'
        WHEN Final_Mark >= 45 THEN 'C+'
        WHEN Final_Mark >= 40 THEN 'C'
        WHEN Final_Mark >= 35 THEN 'C-'
        WHEN Final_Mark >= 30 THEN 'D+'
        WHEN Final_Mark >= 25 THEN 'D'
        ELSE 'E'
    END AS Grade,
    CASE 
        WHEN Final_Mark >= 85 THEN 4.00
        WHEN Final_Mark >= 70 THEN 4.00
        WHEN Final_Mark >= 65 THEN 3.70
        WHEN Final_Mark >= 60 THEN 3.30
        WHEN Final_Mark >= 55 THEN 3.00
        WHEN Final_Mark >= 50 THEN 2.70
        WHEN Final_Mark >= 45 THEN 2.30
        WHEN Final_Mark >= 40 THEN 2.00
        WHEN Final_Mark >= 35 THEN 1.70
        WHEN Final_Mark >= 30 THEN 1.30
        WHEN Final_Mark >= 25 THEN 1.00
        ELSE 0.00
    END AS Grade_Point_Value,
    CASE 
        WHEN Final_Mark >= 85 THEN 'Superior'
        WHEN Final_Mark >= 60 THEN 'Meritorious'
        WHEN Final_Mark >= 45 THEN 'Adequate'
        WHEN Final_Mark >= 30 THEN 'Minimal'
        ELSE 'Failure'
    END AS Attainment
FROM 
    Eligible_Student_Subject_Final_Marks;

------------------------------------------------------------------------
SELECT 
    StudentID,
    Sub_ID,
    Final_Mark,
    Grade,
    Grade_Point_Value,
    Attainment
FROM 
    Eligible_Student_Grades
ORDER BY 
    StudentID, Sub_ID;



------------------------------------------------------------------------------
//////////////////
OUTPUT
//////////////////

+-----------+---------+-------------+-------+-------------------+-------------+
| StudentID | Sub_ID  | Final_Mark  | Grade | Grade_Point_Value | Attainment  |
+-----------+---------+-------------+-------+-------------------+-------------+
| TG1100    | ICT1112 | 41.40000000 | C     |              2.00 | Minimal     |
| TG1101    | ENG1114 | 24.94000000 | E     |              0.00 | Failure     |
| TG1101    | ICT1112 | 46.34000000 | C+    |              2.30 | Adequate    |
| TG1101    | TMS1113 |  8.32000000 | E     |              0.00 | Failure     |
| TG1350    | ENG1114 | 40.60000000 | C     |              2.00 | Minimal     |
| TG1350    | ENG1222 | 42.04000000 | C     |              2.00 | Minimal     |
| TG1350    | ICT1112 | 70.08000000 | A     |              4.00 | Meritorious |
| TG1350    | ICT1122 | 65.96000000 | A-    |              3.70 | Meritorious |
| TG1350    | ICT1132 | 68.74000000 | A-    |              3.70 | Meritorious |
| TG1350    | ICT1142 | 41.02000000 | C     |              2.00 | Minimal     |
| TG1350    | ICT1153 | 39.26000000 | C-    |              1.70 | Minimal     |
| TG1350    | ICT1153 | 39.26000000 | C-    |              1.70 | Minimal     |
| TG1350    | ICT1161 | 41.44000000 | C     |              2.00 | Minimal     |






-------------------------------------------------------
CGPA, SGPA, GPA
---------------------------------------------------------

/////////////////////////
Code
////////////////////////

-- Create or Replace View for Semester 1 SGPA
CREATE OR REPLACE VIEW Sem1_SGPA AS
SELECT 
    e.StudentID,
    SUM(s.Credits * e.Grade_Point_Value) / SUM(s.Credits) AS SGPA_Sem1
FROM 
    Eligible_Student_Grades AS e
JOIN 
    subject AS s ON e.Sub_ID = s.S_Id
WHERE 
    s.Course_code = 'C01' -- assuming this represents semester 1 subjects
GROUP BY 
    e.StudentID;

-- Create or Replace View for Semester 2 SGPA
CREATE OR REPLACE VIEW Sem2_SGPA AS
SELECT 
    e.StudentID,
    SUM(s.Credits * e.Grade_Point_Value) / SUM(s.Credits) AS SGPA_Sem2
FROM 
    Eligible_Student_Grades AS e
JOIN 
    subject AS s ON e.Sub_ID = s.S_Id
WHERE 
    s.Course_code = 'C02' -- assuming this represents semester 2 subjects
GROUP BY 
    e.StudentID;

-- Calculate CGPA across both semesters
CREATE OR REPLACE VIEW Student_CGPA AS
SELECT 
    s1.StudentID,
    (COALESCE(s1.SGPA_Sem1, 0) * (SELECT SUM(Credits) FROM subject WHERE Course_code = 'C01') + 
     COALESCE(s2.SGPA_Sem2, 0) * (SELECT SUM(Credits) FROM subject WHERE Course_code = 'C02')) /
    (SELECT SUM(Credits) FROM subject WHERE Course_code IN ('C01', 'C02')) AS CGPA
FROM 
    Sem1_SGPA AS s1
LEFT JOIN 
    Sem2_SGPA AS s2 ON s1.StudentID = s2.StudentID;

-- --------------------------------------------------
SELECT 
    s.Reg_No AS StudentID,
    COALESCE(s1.SGPA_Sem1, 0) AS SGPA_Sem1,
    COALESCE(s2.SGPA_Sem2, 0) AS SGPA_Sem2,
    c.CGPA AS Cumulative_GPA
FROM 
    student AS s
LEFT JOIN 
    Sem1_SGPA AS s1 ON s.Reg_No = s1.StudentID
LEFT JOIN 
    Sem2_SGPA AS s2 ON s.Reg_No = s2.StudentID
LEFT JOIN 
    Student_CGPA AS c ON s.Reg_No = c.StudentID
ORDER BY 
    s.Reg_No;


-----------------------------------------------------------

///////////////////////////////
OUTPUT
///////////////////////////////
+-----------+-----------+-----------+----------------+
| StudentID | SGPA_Sem1 | SGPA_Sem2 | Cumulative_GPA |
+-----------+-----------+-----------+----------------+
| TG1100    |  2.000000 |  0.000000 |           NULL |
| TG1101    |  0.511111 |  0.000000 |           NULL |
| TG1102    |  0.000000 |  0.000000 |           NULL |
| TG1103    |  0.000000 |  0.000000 |           NULL |
| TG1104    |  0.000000 |  0.000000 |           NULL |
| TG1105    |  0.000000 |  0.000000 |           NULL |
| TG1106    |  0.000000 |  0.000000 |           NULL |
| TG1107    |  0.000000 |  0.000000 |           NULL |
| TG1350    |  2.307500 |  0.000000 |           NULL |
| TG1351    |  2.142500 |  0.000000 |           NULL |
| TG1352    |  2.125000 |  0.000000 |           NULL |
| TG1353    |  1.972500 |  0.000000 |           NULL |
| TG1354    |  2.275000 |  0.000000 |           NULL |
| TG1355    |  2.015625 |  0.000000 |           NULL |
| TG1356    |  1.812500 |  0.000000 |           NULL |
| TG1357    |  2.065625 |  0.000000 |           NULL |
| TG1358    |  2.060000 |  0.000000 |           NULL |
| TG1359    |  2.142500 |  0.000000 |           NULL |
+-----------+-----------+-----------+----------------+
18 rows in set (0.10 sec)



-----------------------------------------------------------------------
Get student status
----------------------------------------------------------------------
///////////
Code
//////////

CREATE OR REPLACE VIEW Sem1_SGPA AS
SELECT 
    e.StudentID,
    AVG(e.Grade_Point_Value) AS SGPA_Sem1
FROM 
    Eligible_Student_Grades AS e
JOIN 
    subject AS s ON e.Sub_ID = s.S_Id
WHERE 
    s.Course_code = 'C01' -- assuming this represents semester 1 subjects
GROUP BY 
    e.StudentID;




------------------------------------------------------------------------
-- Query to classify students
SELECT 
    s.Reg_No AS StudentID,
    COALESCE(sg.SGPA_Sem1, 0) AS SGPA_Sem1,
    CASE 
        WHEN COALESCE(sg.SGPA_Sem1, 0) > 0.00 THEN 'Proper Student'
        WHEN COALESCE(sg.SGPA_Sem1, 0) = 0.00 THEN 'Repeat Student'
        ELSE 'SUSPEND'
    END AS Student_Status
FROM 
    student AS s
LEFT JOIN 
    Sem1_SGPA AS sg ON s.Reg_No = sg.StudentID;
------------------------------------------------------------------------------


    ->     Sem1_SGPA AS sg ON s.Reg_No = sg.StudentID;
+-----------+-----------+----------------+
| StudentID | SGPA_Sem1 | Student_Status |
+-----------+-----------+----------------+
| TG1350    |  2.347059 | Proper Student |
| TG1351    |  2.152941 | Proper Student |
| TG1352    |  2.147059 | Proper Student |
| TG1353    |  2.011765 | Proper Student |
| TG1354    |  2.282353 | Proper Student |
| TG1355    |  1.978571 | Proper Student |
| TG1356    |  1.864706 | Proper Student |
| TG1357    |  2.035714 | Proper Student |
| TG1358    |  2.070588 | Proper Student |
| TG1359    |  2.152941 | Proper Student |
| TG1100    |  2.000000 | Proper Student |
| TG1101    |  0.766667 | Proper Student |
| TG1102    |  0.000000 | Repeat Student |
| TG1103    |  0.000000 | Repeat Student |
| TG1104    |  0.000000 | Repeat Student |
| TG1105    |  0.000000 | Repeat Student |
| TG1106    |  0.000000 | Repeat Student |
| TG1107    |  0.000000 | Repeat Student |
+-----------+-----------+----------------+









